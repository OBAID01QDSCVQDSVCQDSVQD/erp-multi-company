# ูุธุงู ุงูููุงุชูุฑ ุงูุฏุงุฎููุฉ (Facture Interne)

## ูุธุฑุฉ ุนุงูุฉ
ูุธุงู ุงูููุงุชูุฑ ุงูุฏุงุฎููุฉ ูู ูุธุงู ูุฅุฏุงุฑุฉ ุงูููุงุชูุฑ ุบูุฑ ุงููุตุฑุญ ุจูุง ูุฏู ุงููุจุงุถุฉ ุงููุงููุฉ. ูุฐู ุงูููุงุชูุฑ ุชูุณุชุฎุฏู ููุฃุบุฑุงุถ ุงูุฏุงุฎููุฉ ูุงูุฅุญุตุงุฆูุฉ ููุท.

## ุงููููุฒุงุช ุงูุฑุฆูุณูุฉ

### 1. ุงูุฎุตุงุฆุต
- โ ุชูุญุณุจ ูู **chiffre d'affaires** (ุฑูู ุงูุฃุนูุงู)
- โ ุชูุณุชุฎุฏู ูู **ุงููุฑุงุจูุญ ูุงูุฅุญุตุงุฆูุงุช** ูุซู ุงูููุงุชูุฑ ุงูุนุงุฏูุฉ
- โ **ุบูุฑ ูุตุฑุญ ุจูุง** ูููุจุงุถุฉ ุงููุงููุฉ
- โ ูููู ุทุจุงุนุชูุง ูุงุณุชุฎุฏุงููุง ุฏุงุฎููุงู
- โ ุชุณูุณู ุฃุฑูุงู ูููุตู (INT-YYYY-XXXXX)

### 2. ุงููุฑู ุจูู ุงููุงุชูุฑุฉ ุงูุนุงุฏูุฉ ูุงููุงุชูุฑุฉ ุงูุฏุงุฎููุฉ

| ุงูููุฒุฉ | ุงููุงุชูุฑุฉ ุงูุนุงุฏูุฉ | ุงููุงุชูุฑุฉ ุงูุฏุงุฎููุฉ |
|--------|------------------|-------------------|
| ุงูุชุตุฑูุญ ูููุจุงุถุฉ | โ ูุนู | โ ูุง |
| ุงูุญุณุงุจ ูู chiffre d'affaires | โ ูุนู | โ ูุนู |
| ุงูุญุณุงุจ ูู ุงููุฑุงุจูุญ | โ ูุนู | โ ูุนู |
| ุฑูู ุงูุชุณูุณู | INV-YYYY-XXXXX | INT-YYYY-XXXXX |
| ุงูุชุตุฏูุฑ ูููุจุงุถุฉ | โ ูุชุงุญ | โ ุบูุฑ ูุชุงุญ |
| ุงูุงุณุชุฎุฏุงู | ุฑุณูู | ุฏุงุฎูู ููุท |

## ูููุฐุฌ ุงูุจูุงูุงุช (Schema)

```typescript
interface InternalInvoice {
  numero: string;              // INT-YYYY-XXXXX
  date: Date;
  customerId: ObjectId;        // ุงูุนููู (ูููู ุฃู ูููู ุฏุงุฎูู ุฃู ุฎุงุฑุฌู)
  type: 'internal';            // ููุน ุซุงุจุช
  statut: 'brouillon' | 'valide' | 'paye' | 'annule';
  
  // ุงูุนูุงุตุฑ
  items: [{
    productId?: ObjectId;      // ุงุฎุชูุงุฑู (ูููู ุฅุถุงูุฉ ููุชุฌ ูุฎุตุต)
    description: string;
    quantity: number;
    unitPrice: number;
    taxCode: string;           // ููุฏ TVA
    tvaPct: number;
    totalHT: number;
    totalTTC: number;
  }];
  
  // ุงูุญุณุงุจุงุช
  totalHT: number;
  totalTVA: number;
  totalTTC: number;
  
  // ูุนูููุงุช ุฅุถุงููุฉ
  notes?: string;              // ููุงุญุธุงุช
  projetId?: ObjectId;         // ุฑุจุท ุจูุดุฑูุน (ุงุฎุชูุงุฑู)
  
  // ุงูุญุงูุฉ ุงููุงููุฉ
  paymentStatus: 'unpaid' | 'partial' | 'paid';
  paidAmount: number;
  paymentMethod?: string;
  
  // Metadata
  tenantId: string;
  createdBy: ObjectId;
  isInternal: true;            // ุนูุงูุฉ ุซุงุจุชุฉ
  declaredToTax: false;        // ุนูุงูุฉ ุซุงุจุชุฉ - ุบูุฑ ูุตุฑุญ ุจูุง
}
```

## ุงููุธุงุฆู ุงููุทููุจุฉ

### 1. ุงูุตูุญุงุช
- `/internal-invoices` - ูุงุฆูุฉ ุงูููุงุชูุฑ ุงูุฏุงุฎููุฉ
- `/internal-invoices/new` - ุฅูุดุงุก ูุงุชูุฑุฉ ุฏุงุฎููุฉ ุฌุฏูุฏุฉ
- `/internal-invoices/[id]` - ุนุฑุถ ูุงุชูุฑุฉ ุฏุงุฎููุฉ
- `/internal-invoices/[id]/edit` - ุชุนุฏูู ูุงุชูุฑุฉ ุฏุงุฎููุฉ
- `/internal-invoices/dashboard` - ููุญุฉ ุชุญูู ูุฅุญุตุงุฆูุงุช

### 2. API Routes
- `GET /api/internal-invoices` - ุฌูุจ ุงููุงุฆูุฉ (ูุน ููุชุฑุฉ ูุจุญุซ)
- `POST /api/internal-invoices` - ุฅูุดุงุก ูุงุชูุฑุฉ ุฌุฏูุฏุฉ
- `GET /api/internal-invoices/[id]` - ุฌูุจ ูุงุชูุฑุฉ ูุญุฏุฏุฉ
- `PATCH /api/internal-invoices/[id]` - ุชุญุฏูุซ ูุงุชูุฑุฉ
- `DELETE /api/internal-invoices/[id]` - ุญุฐู ูุงุชูุฑุฉ
- `GET /api/internal-invoices/stats` - ุฅุญุตุงุฆูุงุช

### 3. ุงูุฅุญุตุงุฆูุงุช ูุงูุชูุงุฑูุฑ
- ุฅุฌูุงูู ุงูููุงุชูุฑ ุงูุฏุงุฎููุฉ
- ูุฌููุน chiffre d'affaires ูู ุงูููุงุชูุฑ ุงูุฏุงุฎููุฉ
- ุนุฏุฏ ุงูููุงุชูุฑ ุญุณุจ ุงูุญุงูุฉ
- ูุฎุทุท ุฒููู ููููุงุชูุฑ ุงูุฏุงุฎููุฉ
- **ููุงุญุธุฉ:** ุชูุญุณุจ ุงูููุงุชูุฑ ุงูุฏุงุฎููุฉ ูู ุชูุงุฑูุฑ chiffre d'affaires ุงูุนุงูุฉ ูููู ูุน ุนูุงูุฉ ูููุฒุฉ

## ุงููุงุฌูุฉ

### ูุงุฆูุฉ ุงูููุงุชูุฑ ุงูุฏุงุฎููุฉ
- ุฌุฏูู ูุนุฑุถ: ุงูุฑููุ ุงูุชุงุฑูุฎุ ุงูุนูููุ ุงููุจูุบ TTCุ ุงูุญุงูุฉุ ุงูุฅุฌุฑุงุกุงุช
- ููุชุฑุฉ ุญุณุจ: ุงูุชุงุฑูุฎุ ุงูุญุงูุฉุ ุงูุนููู
- ุจุญุซ: ุจุงูุฑููุ ุงุณู ุงูุนููู

### ูููุฐุฌ ุงูุฅูุดุงุก/ุงูุชุนุฏูู
- ูุนูููุงุช ุนุงูุฉ: ุงูุชุงุฑูุฎุ ุงูุนูููุ ุงููุดุฑูุน (ุงุฎุชูุงุฑู)
- ุงูุนูุงุตุฑ: ุฌุฏูู ุฏููุงูููู ูุฅุถุงูุฉ ุงูููุชุฌุงุช/ุงูุฎุฏูุงุช
- ุงูุญุณุงุจุงุช: ุฅุฌูุงูู HTุ TVAุ TTC (ุญุณุงุจ ุชููุงุฆู)
- ููุงุญุธุงุช: ุญูู ูุตู

### ููุญุฉ ุงูุชุญูู
- ุจุทุงูุงุช ุฅุญุตุงุฆูุฉ:
  - ุฅุฌูุงูู ุงูููุงุชูุฑ ุงูุฏุงุฎููุฉ
  - ูุฌููุน chiffre d'affaires
  - ุงูููุงุชูุฑ ุงููุนููุฉ
  - ุงูููุงุชูุฑ ุงููุณุฏุฏุฉ
- ูุฎุทุท ุจูุงูู ููููุงุชูุฑ ุญุณุจ ุงูุดูุฑ

## ุงูุชูุงูู ูุน ุงูุฃูุธูุฉ ุงูุฃุฎุฑู

### Dashboard ุงูุฑุฆูุณู
- ุชูุญุณุจ ุงูููุงุชูุฑ ุงูุฏุงุฎููุฉ ูู ุฅุฌูุงูู chiffre d'affaires
- ุชูุธูุฑ ูุน ุนูุงูุฉ ูููุฒุฉ (ุฃููููุฉ ุฃู ููู ูุฎุชูู)

### ุชูุงุฑูุฑ chiffre d'affaires
- ูุตููุฉ ุจูู:
  - chiffre d'affaires ูุตุฑุญ ุจู (ุงูููุงุชูุฑ ุงูุนุงุฏูุฉ)
  - chiffre d'affaires ุบูุฑ ูุตุฑุญ ุจู (ุงูููุงุชูุฑ ุงูุฏุงุฎููุฉ)
  - ุงูุฅุฌูุงูู

### ุญุณุงุจ ุงููุฑุงุจูุญ
- ุชูุณุชุฎุฏู ุงูููุงุชูุฑ ุงูุฏุงุฎููุฉ ูู ุญุณุงุจ ุงููุฑุงุจูุญ
- ููููุง ุชูุธูุฑ ุจุดูู ูููุตู ูู ุงูุชูุงุฑูุฑ

## ุงูุฃูุงู
- ุตูุงุญูุฉ ุฎุงุตุฉ: `internal_invoices`
- ุงููุณุชุฎุฏููู ุงูุฐูู ูุฏููู ูุฐู ุงูุตูุงุญูุฉ ููุท ูููููู:
  - ุฅูุดุงุก ููุงุชูุฑ ุฏุงุฎููุฉ
  - ุนุฑุถ ููุงุชูุฑ ุฏุงุฎููุฉ
  - ุชุนุฏูู/ุญุฐู ููุงุชูุฑ ุฏุงุฎููุฉ

## ุงูุชูููุฒ ุงูุจุตุฑู
- ููู ูููุฒ: ุจุฑุชูุงูู ุฃู ุฃุฑุฌูุงูู (ูุฎุชูู ุนู ุงูุฃุฒุฑู ููููุงุชูุฑ ุงูุนุงุฏูุฉ)
- ุฃููููุฉ ูููุฒุฉ: ๐ ุฃู ๐
- ุนูุงูุฉ "Interne" ูู ุงูุนููุงู ูุงูุทุจุงุนุฉ










